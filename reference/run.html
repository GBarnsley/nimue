<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run the vaccine model — run • nimue</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run the vaccine model — run" />
<meta property="og:description" content="Run the vaccine model" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nimue</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Coverage_and_Prioritisation.html">Coverage and Prioritisation</a>
    </li>
    <li>
      <a href="../articles/Efficacy.html">Efficacy</a>
    </li>
    <li>
      <a href="../articles/Model_equations.html">Model equations</a>
    </li>
    <li>
      <a href="../articles/Supply.html">Supply</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run the vaccine model</h1>
    
    <div class="hidden name"><code>run.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run the vaccine model</p>
    </div>

    <pre class="usage"><span class='fu'>run</span><span class='op'>(</span>
  country <span class='op'>=</span> <span class='cn'>NULL</span>,
  population <span class='op'>=</span> <span class='cn'>NULL</span>,
  tt_contact_matrix <span class='op'>=</span> <span class='fl'>0</span>,
  contact_matrix_set <span class='op'>=</span> <span class='cn'>NULL</span>,
  R0 <span class='op'>=</span> <span class='fl'>3</span>,
  tt_R0 <span class='op'>=</span> <span class='fl'>0</span>,
  beta_set <span class='op'>=</span> <span class='cn'>NULL</span>,
  time_period <span class='op'>=</span> <span class='fl'>365</span>,
  replicates <span class='op'>=</span> <span class='fl'>10</span>,
  seed <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1e+08</span><span class='op'>)</span>,
  prob_hosp <span class='op'>=</span> <span class='va'>probs</span><span class='op'>$</span><span class='va'>prob_hosp</span>,
  prob_severe <span class='op'>=</span> <span class='va'>probs</span><span class='op'>$</span><span class='va'>prob_severe</span>,
  prob_non_severe_death_treatment <span class='op'>=</span> <span class='va'>probs</span><span class='op'>$</span><span class='va'>prob_non_severe_death_treatment</span>,
  prob_non_severe_death_no_treatment <span class='op'>=</span> <span class='va'>probs</span><span class='op'>$</span><span class='va'>prob_non_severe_death_no_treatment</span>,
  prob_severe_death_treatment <span class='op'>=</span> <span class='va'>probs</span><span class='op'>$</span><span class='va'>prob_severe_death_treatment</span>,
  prob_severe_death_no_treatment <span class='op'>=</span> <span class='va'>probs</span><span class='op'>$</span><span class='va'>prob_severe_death_no_treatment</span>,
  p_dist <span class='op'>=</span> <span class='va'>probs</span><span class='op'>$</span><span class='va'>p_dist</span>,
  rel_infectiousness <span class='op'>=</span> <span class='va'>probs</span><span class='op'>$</span><span class='va'>rel_infectiousness</span>,
  rel_infectiousness_vaccinated <span class='op'>=</span> <span class='va'>probs</span><span class='op'>$</span><span class='va'>rel_infectiousness_vaccinated</span>,
  dur_E <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_E</span>,
  dur_IMild <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_IMild</span>,
  dur_ICase <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_ICase</span>,
  dur_get_ox_survive <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_get_ox_survive</span>,
  dur_get_ox_die <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_get_ox_die</span>,
  dur_not_get_ox_survive <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_not_get_ox_survive</span>,
  dur_not_get_ox_die <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_not_get_ox_die</span>,
  dur_get_mv_survive <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_get_mv_survive</span>,
  dur_get_mv_die <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_get_mv_die</span>,
  dur_not_get_mv_survive <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_not_get_mv_survive</span>,
  dur_not_get_mv_die <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_not_get_mv_die</span>,
  dur_rec <span class='op'>=</span> <span class='va'>durs</span><span class='op'>$</span><span class='va'>dur_rec</span>,
  dur_R <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>dur_R</span>,
  dur_V <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>dur_V</span>,
  vaccine_efficacy_infection <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>vaccine_efficacy_infection</span>,
  tt_vaccine_efficacy_infection <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>tt_vaccine_efficacy_infection</span>,
  vaccine_efficacy_disease <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>vaccine_efficacy_disease</span>,
  tt_vaccine_efficacy_disease <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>tt_vaccine_efficacy_disease</span>,
  max_vaccine <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>max_vaccine</span>,
  tt_vaccine <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>tt_vaccine</span>,
  dur_vaccine_delay <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>dur_vaccine_delay</span>,
  vaccine_coverage_mat <span class='op'>=</span> <span class='va'>vaccine_pars</span><span class='op'>$</span><span class='va'>vaccine_coverage_mat</span>,
  hosp_bed_capacity <span class='op'>=</span> <span class='cn'>NULL</span>,
  ICU_bed_capacity <span class='op'>=</span> <span class='cn'>NULL</span>,
  tt_hosp_beds <span class='op'>=</span> <span class='fl'>0</span>,
  tt_ICU_beds <span class='op'>=</span> <span class='fl'>0</span>,
  seeding_cases <span class='op'>=</span> <span class='fl'>20</span>,
  seeding_age_order <span class='op'>=</span> <span class='cn'>NULL</span>,
  init <span class='op'>=</span> <span class='cn'>NULL</span>,
  use_dde <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>country</th>
      <td><p>Character for country beign simulated. WIll be used to
generate <code>population</code> and <code>contact_matrix_set</code> if
unprovided. Either <code>country</code> or <code>population</code> and
<code>contact_matrix_set</code> must be provided.</p></td>
    </tr>
    <tr>
      <th>population</th>
      <td><p>Population vector (for each age group). Default = NULL,
which will cause population to be sourced from <code>country</code></p></td>
    </tr>
    <tr>
      <th>tt_contact_matrix</th>
      <td><p>Time change points for matrix change. Default = 0</p></td>
    </tr>
    <tr>
      <th>contact_matrix_set</th>
      <td><p>Contact matrices used in simulation. Default =
NULL, which will generate this based on the <code>country</code>.</p></td>
    </tr>
    <tr>
      <th>R0</th>
      <td><p>Basic Reproduction Number. Default = 3</p></td>
    </tr>
    <tr>
      <th>tt_R0</th>
      <td><p>Change time points for R0. Default = 0</p></td>
    </tr>
    <tr>
      <th>beta_set</th>
      <td><p>Alternative parameterisation via beta rather than R0.
Default = NULL, which causes beta to be estimated from R0</p></td>
    </tr>
    <tr>
      <th>time_period</th>
      <td><p>Length of simulation. Default = 365</p></td>
    </tr>
    <tr>
      <th>replicates</th>
      <td><p>Number of replicates. Default = 10</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Random seed used for simulations. Deafult = runif(1, 0, 10000)</p></td>
    </tr>
    <tr>
      <th>prob_hosp</th>
      <td><p>probability of hospitalisation by age.
Default = c(0.000744192, 0.000634166,0.001171109, 0.002394593, 0.005346437,
0.010289885, 0.016234604, 0.023349169, 0.028944623, 0.038607042,
0.057734879, 0.072422135, 0.101602458, 0.116979814, 0.146099064,
0.176634654 ,0.180000000)</p></td>
    </tr>
    <tr>
      <th>prob_severe</th>
      <td><p>Probability of developing severe symptoms by age.
Default = c(0.05022296,    0.05022296,    0.05022296,    0.05022296,    0.05022296,
0.05022296,    0.05022296,    0.053214942, 0.05974426,    0.074602879,
0.103612417, 0.149427991, 0.223777304,    0.306985918,
0.385779555, 0.461217861, 0.709444444)</p></td>
    </tr>
    <tr>
      <th>prob_non_severe_death_treatment</th>
      <td><p>Probability of death from non severe
treated infection.
Default = c(0.0125702,    0.0125702,    0.0125702,    0.0125702,
0.0125702,    0.0125702,    0.0125702,    0.013361147,
0.015104687,    0.019164124,    0.027477519,    0.041762108,
0.068531658,    0.105302319,    0.149305732,    0.20349534,    0.5804312)</p></td>
    </tr>
    <tr>
      <th>prob_non_severe_death_no_treatment</th>
      <td><p>Probability of death in non severe
hospital inections that aren't treated</p></td>
    </tr>
    <tr>
      <th>prob_severe_death_treatment</th>
      <td><p>Probability of death from severe infection
that is treated. Default = rep(0.5, 17)</p></td>
    </tr>
    <tr>
      <th>prob_severe_death_no_treatment</th>
      <td><p>Probability of death from severe infection
that is not treated. Default = rep(0.95, 17)</p></td>
    </tr>
    <tr>
      <th>p_dist</th>
      <td><p>Preferentiality of age group receiving treatment relative to
other age groups when demand exceeds healthcare capacity.</p></td>
    </tr>
    <tr>
      <th>rel_infectiousness</th>
      <td><p>Relative infectiousness per age category relative
to maximum infectiousness category. Default = rep(1, 17)</p></td>
    </tr>
    <tr>
      <th>rel_infectiousness_vaccinated</th>
      <td><p>Relative infectiousness per age
category  of vaccinated individuals relative to unvaccinated individuals.
Default = rep(1, 17), which is no impact of vaccination on onwards
transmissions</p></td>
    </tr>
    <tr>
      <th>dur_E</th>
      <td><p>Mean duration of incubation period (days). Default = 4.6</p></td>
    </tr>
    <tr>
      <th>dur_IMild</th>
      <td><p>Mean duration of mild infection (days). Default = 2.1</p></td>
    </tr>
    <tr>
      <th>dur_ICase</th>
      <td><p>Mean duration from symptom onset to hospitil admission (days).
Default = 4.5</p></td>
    </tr>
    <tr>
      <th>dur_get_ox_survive</th>
      <td><p>Mean duration of oxygen given survive. Default = 5</p></td>
    </tr>
    <tr>
      <th>dur_get_ox_die</th>
      <td><p>Mean duration of oxygen given death. Default = 5</p></td>
    </tr>
    <tr>
      <th>dur_not_get_ox_survive</th>
      <td><p>Mean duration without oxygen given survive.
Default = 5</p></td>
    </tr>
    <tr>
      <th>dur_not_get_ox_die</th>
      <td><p>Mean duration without  oxygen given death.
Default = 5</p></td>
    </tr>
    <tr>
      <th>dur_get_mv_survive</th>
      <td><p>Mean duration of ventilation given survive.
Default = 7.3</p></td>
    </tr>
    <tr>
      <th>dur_get_mv_die</th>
      <td><p>Mean duration of ventilation given death. Default = 6</p></td>
    </tr>
    <tr>
      <th>dur_not_get_mv_survive</th>
      <td><p>Mean duration without ventilation given
survive. Default = 7.3</p></td>
    </tr>
    <tr>
      <th>dur_not_get_mv_die</th>
      <td><p>Mean duration without ventilation given
death. Default = 1</p></td>
    </tr>
    <tr>
      <th>dur_rec</th>
      <td><p>Duration of recovery after coming off ventilation. Default = 2</p></td>
    </tr>
    <tr>
      <th>dur_R</th>
      <td><p>Mean duration of naturally acquired immunity (days)</p></td>
    </tr>
    <tr>
      <th>dur_V</th>
      <td><p>Mean duration of vaccine-derived immunity (days)</p></td>
    </tr>
    <tr>
      <th>vaccine_efficacy_infection</th>
      <td><p>Efficacy of vaccine against infection.
This parameter must either be length 1 numeric (a single efficacy for all
age groups) or length 17 numeric vector (an efficacy for each age group).
An efficacy of 1 will reduce FOI by 100 percent, an efficacy of 0.2 will
reduce FOI by 20 percent etc.
To specify changes in vaccine efficacy over time, vaccine efficacies must
be provided as a list, with each list element being the efficacy at each
time point specified by <code>tt_vaccine_efficacy_infection</code>. These
efficacies must also be length 1 numeric (a single efficacy for all age
groups)  or length 17 numeric vector (an efficacy for each age group)</p></td>
    </tr>
    <tr>
      <th>tt_vaccine_efficacy_infection</th>
      <td><p>Timing of changes in vaccine efficacy
against infection. Default = 0, which assumes fixed efficacy over time.
Must be the same length as the length of <code>vaccine_efficacy_infection</code>
when provided as a list. Time changing efficacies can occur in response to
changing vaccines being  given and dosing strategy changes.</p></td>
    </tr>
    <tr>
      <th>vaccine_efficacy_disease</th>
      <td><p>Efficacy of vaccine against severe
(requiring hospitilisation) disease (by age). This parameter must either be
length 1 numeric (a single efficacy for all age groups) or length 17
numeric vector (an efficacy for each age group). An efficacy of 1 will
reduce the probability of hospitalisation by 100 percent, an efficacy of
0.2 will reduce the probability of hospitalisation by 20 percent etc.
To specify changes in vaccine efficacy over time, vaccine efficacies must
be provided as a list, with each list element being the efficacy at each
time point specified by <code>tt_vaccine_efficacy_disease</code>. These
efficacies must also be length 1 numeric (a single efficacy for all age
groups)  or length 17 numeric vector (an efficacy for each age group).</p></td>
    </tr>
    <tr>
      <th>tt_vaccine_efficacy_disease</th>
      <td><p>Timing of changes in vaccine efficacy
against disease. Default = 0, which assumes fixed efficacy over time.
Must be the same length as the length of <code>vaccine_efficacy_disease</code>
when provided as a list. Time changing efficacies can occur in response to
changing vaccines being  given and dosing strategy changes.</p></td>
    </tr>
    <tr>
      <th>max_vaccine</th>
      <td><p>The maximum number of individuals who can be vaccinated per day.</p></td>
    </tr>
    <tr>
      <th>tt_vaccine</th>
      <td><p>Time change points for vaccine capacity (<code>max_vaccine</code>).</p></td>
    </tr>
    <tr>
      <th>dur_vaccine_delay</th>
      <td><p>Mean duration of period from vaccination to vaccine protection.</p></td>
    </tr>
    <tr>
      <th>vaccine_coverage_mat</th>
      <td><p>Vaccine coverage targets by age (columns) and priority (row)</p></td>
    </tr>
    <tr>
      <th>hosp_bed_capacity</th>
      <td><p>General bed capacity. Can be single number of vector if capacity time-varies.</p></td>
    </tr>
    <tr>
      <th>ICU_bed_capacity</th>
      <td><p>ICU bed capacity. Can be single number of vector if capacity time-varies.</p></td>
    </tr>
    <tr>
      <th>tt_hosp_beds</th>
      <td><p>Times at which hospital bed capacity changes (Default = 0 = doesn't change)</p></td>
    </tr>
    <tr>
      <th>tt_ICU_beds</th>
      <td><p>Times at which ICU bed capacity changes (Default = 0 = doesn't change)</p></td>
    </tr>
    <tr>
      <th>seeding_cases</th>
      <td><p>Initial number of cases seeding the epidemic</p></td>
    </tr>
    <tr>
      <th>seeding_age_order</th>
      <td><p>Vector specifying the order in which seeds are allocated to ages.
If NULL, seeds are distributed randomly within working ages. If specified, must be a vector
of length 17 specifying the order seeds are allocated, e.g. 1:17 will allocate first seed
to the youngest age group, then the second youngest and so on. Default = NULL</p></td>
    </tr>
    <tr>
      <th>init</th>
      <td><p>Initial conditions for simulation provided. Allows overriding
if initial conditions start with an already infected population etc.
Default = NULL.</p></td>
    </tr>
    <tr>
      <th>use_dde</th>
      <td><p>Use the dde solver (default is <code>TRUE</code>)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments for solver</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Simulation output</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Peter Winskill, OJ Watson, Alexandra Hogan.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


